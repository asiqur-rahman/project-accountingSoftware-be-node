CREATE OR REPLACE  PROCEDURE Dashboard(
	todayDate date,
	userId INT
)
BEGIN
	DECLARE totalSale INT DEFAULT 0;
	DECLARE preTotalSale INT DEFAULT 0;
	-- DROP PROCEDURE IF EXISTS `Dashboard`;
	DECLARE totalOrder INT DEFAULT 0;
	DECLARE preTotalOrder INT DEFAULT 0;
	DECLARE totalSupply INT DEFAULT 0;
	DECLARE preTotalSupply INT DEFAULT 0;
	DECLARE cash1 INT DEFAULT 0;
	DECLARE cash2 INT DEFAULT 0;
	DECLARE cash3 INT DEFAULT 0;
	DECLARE cash4 INT DEFAULT 0;
	DECLARE cash5 INT DEFAULT 0;
	DECLARE cash6 INT DEFAULT 0;
	DECLARE cash7 INT DEFAULT 0;
	DECLARE card1 INT DEFAULT 0;
	DECLARE card2 INT DEFAULT 0;
	DECLARE card3 INT DEFAULT 0;
	DECLARE card4 INT DEFAULT 0;
	DECLARE card5 INT DEFAULT 0;
	DECLARE card6 INT DEFAULT 0;
	DECLARE card7 INT DEFAULT 0;
	DECLARE cheque1 INT DEFAULT 0;
	DECLARE cheque2 INT DEFAULT 0;
	DECLARE cheque3 INT DEFAULT 0;
	DECLARE cheque4 INT DEFAULT 0;
	DECLARE cheque5 INT DEFAULT 0;
	DECLARE cheque6 INT DEFAULT 0;
	DECLARE cheque7 INT DEFAULT 0;
	
	select IFNULL((s.cash+s.card+s.cheque),0) INTO totalSale from sales s where s.`date`=CURDATE();
	
	select IFNULL((s.cash+s.card+s.cheque),0) INTO preTotalSale from sales s where s.`date`= DATE_SUB(CURDATE(), INTERVAL 1 DAY);
	
	select count(s.id) into totalOrder from sales s where s.`date`=CURDATE();

	select count(s.id) into preTotalOrder from sales s where s.`date`= DATE_SUB(CURDATE(), INTERVAL 1 DAY);

	select IFNULL(SUM(s.amount),0) into totalSupply from supplies s where s.`date`=CURDATE();
   	
	select IFNULL(SUM(s.amount),0) into preTotalSupply from supplies s where s.`date`= DATE_SUB(CURDATE(), INTERVAL 1 DAY);

	-- Chart

	-- select GROUP_CONCAT(s.cash SEPARATOR ','),GROUP_CONCAT(s.card SEPARATOR ','),GROUP_CONCAT(s.cheque  SEPARATOR ',') from sales s where s.`date` BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 DAY) and DATE_SUB(CURDATE(), INTERVAL 7 DAY)
	
	select s.cash into cash1 from sales s where `date` = DATE_SUB(CURDATE(), INTERVAL 1 DAY);
	select s.cash into cash2 from sales s where `date` = DATE_SUB(CURDATE(), INTERVAL 2 DAY);
	select s.cash into cash3 from sales s where `date` = DATE_SUB(CURDATE(), INTERVAL 3 DAY);
	select s.cash into cash4 from sales s where `date` = DATE_SUB(CURDATE(), INTERVAL 4 DAY);
	select s.cash into cash5 from sales s where `date` = DATE_SUB(CURDATE(), INTERVAL 5 DAY);
	select s.cash into cash6 from sales s where `date` = DATE_SUB(CURDATE(), INTERVAL 6 DAY);
	select s.cash into cash7 from sales s where `date` = DATE_SUB(CURDATE(), INTERVAL 7 DAY);
	
	select s.card into card1 from sales s where `date` = DATE_SUB(CURDATE(), INTERVAL 1 DAY);
	select s.card into card2 from sales s where `date` = DATE_SUB(CURDATE(), INTERVAL 2 DAY);
	select s.card into card3 from sales s where `date` = DATE_SUB(CURDATE(), INTERVAL 3 DAY);
	select s.card into card4 from sales s where `date` = DATE_SUB(CURDATE(), INTERVAL 4 DAY);
	select s.card into card5 from sales s where `date` = DATE_SUB(CURDATE(), INTERVAL 5 DAY);
	select s.card into card6 from sales s where `date` = DATE_SUB(CURDATE(), INTERVAL 6 DAY);
	select s.card into card7 from sales s where `date` = DATE_SUB(CURDATE(), INTERVAL 7 DAY);

	select s.cheque into cheque1 from sales s where `date` = DATE_SUB(CURDATE(), INTERVAL 1 DAY);
	select s.cheque into cheque2 from sales s where `date` = DATE_SUB(CURDATE(), INTERVAL 2 DAY);
	select s.cheque into cheque3 from sales s where `date` = DATE_SUB(CURDATE(), INTERVAL 3 DAY);
	select s.cheque into cheque4 from sales s where `date` = DATE_SUB(CURDATE(), INTERVAL 4 DAY);
	select s.cheque into cheque5 from sales s where `date` = DATE_SUB(CURDATE(), INTERVAL 5 DAY);
	select s.cheque into cheque6 from sales s where `date` = DATE_SUB(CURDATE(), INTERVAL 6 DAY);
	select s.cheque into cheque7 from sales s where `date` = DATE_SUB(CURDATE(), INTERVAL 7 DAY);

	SELECT totalSale AS Total_Sales,
	preTotalSale AS Today_Sales_Pre,
	totalOrder AS Today_Orders,
	preTotalOrder AS Today_Orders_Pre,
	totalSupply AS Today_Supplies,
	preTotalSupply AS Today_Supplies_Pre,
	CONCAT(IFNULL(cash1,0),',',IFNULL(cash2,0),',',IFNULL(cash3,0),',',IFNULL(cash4,0),',',IFNULL(cash5,0),',',IFNULL(cash6,0),',',IFNULL(cash7,0)) AS ToTal_Cash_7,
	CONCAT(IFNULL(card1,0),',',IFNULL(card2,0),',',IFNULL(card3,0),',',IFNULL(card4,0),',',IFNULL(card5,0),',',IFNULL(card6,0),',',IFNULL(card7,0)) AS ToTal_Card_7,
	CONCAT(IFNULL(cheque1,0),',',IFNULL(cheque2,0),',',IFNULL(cheque3,0),',',IFNULL(cheque4,0),',',IFNULL(cheque5,0),',',IFNULL(cheque6,0),',',IFNULL(cheque7,0)) AS ToTal_Cheque_7
;
END;